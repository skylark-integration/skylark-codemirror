{"version":3,"sources":["primitives/display/mode_state.js"],"names":["define","models","highlight_worker","view_tracking","resetModeState","cm","doc","iter","line","stateAfter","styles","modeFrontier","highlightFrontier","first","startWorker","state","modeGen","curOp","regChange","loadMode","mode","getMode","options","modeOption"],"mappings":";;;;;;;AAAAA,QACI,WACA,qBACA,mBACD,SAAUC,EAAQC,EAAkBC,GACnC,aAKA,SAASC,EAAeC,GACpBA,EAAGC,IAAIC,KAAKC,IACJA,EAAKC,aACLD,EAAKC,WAAa,MAClBD,EAAKE,SACLF,EAAKE,OAAS,QAEtBL,EAAGC,IAAIK,aAAeN,EAAGC,IAAIM,kBAAoBP,EAAGC,IAAIO,MACxDX,EAAiBY,YAAYT,EAAI,KACjCA,EAAGU,MAAMC,UACLX,EAAGY,OACHd,EAAce,UAAUb,GAEhC,OACIc,SAlBJ,SAAkBd,GACdA,EAAGC,IAAIc,KAAOnB,EAAOoB,QAAQhB,EAAGiB,QAASjB,EAAGC,IAAIiB,YAChDnB,EAAeC,IAiBfD,eAAgBA","file":"../../../primitives/display/mode_state.js","sourcesContent":["define([\n    '../modes',\n    './highlight_worker',\n    './view_tracking'\n], function (models, highlight_worker, view_tracking) {\n    'use strict';\n    function loadMode(cm) {\n        cm.doc.mode = models.getMode(cm.options, cm.doc.modeOption);\n        resetModeState(cm);\n    }\n    function resetModeState(cm) {\n        cm.doc.iter(line => {\n            if (line.stateAfter)\n                line.stateAfter = null;\n            if (line.styles)\n                line.styles = null;\n        });\n        cm.doc.modeFrontier = cm.doc.highlightFrontier = cm.doc.first;\n        highlight_worker.startWorker(cm, 100);\n        cm.state.modeGen++;\n        if (cm.curOp)\n            view_tracking.regChange(cm);\n    }\n    return {\n        loadMode: loadMode,\n        resetModeState: resetModeState\n    };\n});"]}