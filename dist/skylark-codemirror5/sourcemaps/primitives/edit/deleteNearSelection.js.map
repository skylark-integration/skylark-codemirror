{"version":3,"sources":["primitives/edit/deleteNearSelection.js"],"names":["define","a","b","c","d","e","deleteNearSelection","cm","compute","ranges","doc","sel","kill","i","length","toKill","cmp","from","lst","to","replaced","pop","push","runInOp","replaceRange","ensureCursorVisible"],"mappings":";;;;;;;AAAAA,QACI,wBACA,uBACA,cACA,mBACA,gBACD,SAAUC,EAAGC,EAAGC,EAAGC,EAAGC,GACrB,aAoBA,OAASC,oBAnBT,SAA6BC,EAAIC,GAC7B,IAAIC,EAASF,EAAGG,IAAIC,IAAIF,OAAQG,KAChC,IAAK,IAAIC,EAAI,EAAGA,EAAIJ,EAAOK,OAAQD,IAAK,CACpC,IAAIE,EAASP,EAAQC,EAAOI,IAC5B,KAAOD,EAAKE,QAAUX,EAAEa,IAAID,EAAOE,KAAMZ,EAAEa,IAAIN,GAAMO,KAAO,GAAG,CAC3D,IAAIC,EAAWR,EAAKS,MACpB,GAAIlB,EAAEa,IAAII,EAASH,KAAMF,EAAOE,MAAQ,EAAG,CACvCF,EAAOE,KAAOG,EAASH,KACvB,OAGRL,EAAKU,KAAKP,GAEdd,EAAEsB,QAAQhB,EAAI,KACV,IAAK,IAAIM,EAAID,EAAKE,OAAS,EAAGD,GAAK,EAAGA,IAClCT,EAAEoB,aAAajB,EAAGG,IAAK,GAAIE,EAAKC,GAAGI,KAAML,EAAKC,GAAGM,GAAI,WACzDjB,EAAEuB,oBAAoBlB","file":"../../../primitives/edit/deleteNearSelection.js","sourcesContent":["define([\n    '../display/operations',\n    '../display/scrolling',\n    '../line/pos',\n    '../model/changes',\n    '../util/misc'\n], function (a, b, c, d, e) {\n    'use strict';\n    function deleteNearSelection(cm, compute) {\n        let ranges = cm.doc.sel.ranges, kill = [];\n        for (let i = 0; i < ranges.length; i++) {\n            let toKill = compute(ranges[i]);\n            while (kill.length && c.cmp(toKill.from, e.lst(kill).to) <= 0) {\n                let replaced = kill.pop();\n                if (c.cmp(replaced.from, toKill.from) < 0) {\n                    toKill.from = replaced.from;\n                    break;\n                }\n            }\n            kill.push(toKill);\n        }\n        a.runInOp(cm, () => {\n            for (let i = kill.length - 1; i >= 0; i--)\n                d.replaceRange(cm.doc, '', kill[i].from, kill[i].to, '+delete');\n            b.ensureCursorVisible(cm);\n        });\n    }\n    return { deleteNearSelection: deleteNearSelection };\n});"]}