/**
 * skylark-codemirror5 - A version of codemirror 5.17.1  that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-codemirror5/
 * @license MIT
 */
define(["./deleteNearSelection","../display/operations","../display/scrolling","../input/movement","../line/pos","../line/spans","../line/utils_line","../model/selection","../model/selection_updates","../util/misc","../util/bidi"],function(e,o,t,n,i,l,r,d,c,s,a){"use strict";function h(e,o){let t=r.getLine(e.doc,o),i=l.visualLine(t);return i!=t&&(o=r.lineNo(i)),n.endOfLine(!0,e,i,o,1)}function g(e,o){let t=h(e,o.line),n=r.getLine(e.doc,t.line),l=a.getOrder(n,e.doc.direction);if(!l||0==l[0].level){let e=Math.max(0,n.text.search(/\S/)),l=o.line==t.line&&o.ch<=e&&o.ch;return i.Pos(t.line,l?0:e,t.sticky)}return t}return{commands:{selectAll:c.selectAll,singleSelection:e=>e.setSelection(e.getCursor("anchor"),e.getCursor("head"),s.sel_dontScroll),killLine:o=>e.deleteNearSelection(o,e=>{if(e.empty()){let t=r.getLine(o.doc,e.head.line).text.length;return e.head.ch==t&&e.head.line<o.lastLine()?{from:e.head,to:i.Pos(e.head.line+1,0)}:{from:e.head,to:i.Pos(e.head.line,t)}}return{from:e.from(),to:e.to()}}),deleteLine:o=>e.deleteNearSelection(o,e=>({from:i.Pos(e.from().line,0),to:i.clipPos(o.doc,i.Pos(e.to().line+1,0))})),delLineLeft:o=>e.deleteNearSelection(o,e=>({from:i.Pos(e.from().line,0),to:e.from()})),delWrappedLineLeft:o=>e.deleteNearSelection(o,e=>{let t=o.charCoords(e.head,"div").top+5;return{from:o.coordsChar({left:0,top:t},"div"),to:e.from()}}),delWrappedLineRight:o=>e.deleteNearSelection(o,e=>{let t=o.charCoords(e.head,"div").top+5,n=o.coordsChar({left:o.display.lineDiv.offsetWidth+100,top:t},"div");return{from:e.from(),to:n}}),undo:e=>e.undo(),redo:e=>e.redo(),undoSelection:e=>e.undoSelection(),redoSelection:e=>e.redoSelection(),goDocStart:e=>e.extendSelection(i.Pos(e.firstLine(),0)),goDocEnd:e=>e.extendSelection(i.Pos(e.lastLine())),goLineStart:e=>e.extendSelectionsBy(o=>h(e,o.head.line),{origin:"+move",bias:1}),goLineStartSmart:e=>e.extendSelectionsBy(o=>g(e,o.head),{origin:"+move",bias:1}),goLineEnd:e=>e.extendSelectionsBy(o=>(function(e,o){let t=r.getLine(e.doc,o),i=l.visualLineEnd(t);i!=t&&(o=r.lineNo(i));return n.endOfLine(!0,e,t,o,-1)})(e,o.head.line),{origin:"+move",bias:-1}),goLineRight:e=>e.extendSelectionsBy(o=>{let t=e.cursorCoords(o.head,"div").top+5;return e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:t},"div")},s.sel_move),goLineLeft:e=>e.extendSelectionsBy(o=>{let t=e.cursorCoords(o.head,"div").top+5;return e.coordsChar({left:0,top:t},"div")},s.sel_move),goLineLeftSmart:e=>e.extendSelectionsBy(o=>{let t=e.cursorCoords(o.head,"div").top+5,n=e.coordsChar({left:0,top:t},"div");return n.ch<e.undefined(n.line).search(/\S/)?g(e,o.head):n},s.sel_move),goLineUp:e=>e.moveV(-1,"line"),goLineDown:e=>e.moveV(1,"line"),goPageUp:e=>e.moveV(-1,"page"),goPageDown:e=>e.moveV(1,"page"),goCharLeft:e=>e.moveH(-1,"char"),goCharRight:e=>e.moveH(1,"char"),goColumnLeft:e=>e.moveH(-1,"column"),goColumnRight:e=>e.moveH(1,"column"),goWordLeft:e=>e.moveH(-1,"word"),goGroupRight:e=>e.moveH(1,"group"),goGroupLeft:e=>e.moveH(-1,"group"),goWordRight:e=>e.moveH(1,"word"),delCharBefore:e=>e.deleteH(-1,"char"),delCharAfter:e=>e.deleteH(1,"char"),delWordBefore:e=>e.deleteH(-1,"word"),delWordAfter:e=>e.deleteH(1,"word"),delGroupBefore:e=>e.deleteH(-1,"group"),delGroupAfter:e=>e.deleteH(1,"group"),indentAuto:e=>e.indentSelection("smart"),indentMore:e=>e.indentSelection("add"),indentLess:e=>e.indentSelection("subtract"),insertTab:e=>e.replaceSelection("\t"),insertSoftTab:e=>{let o=[],t=e.listSelections(),n=e.options.tabSize;for(let i=0;i<t.length;i++){let l=t[i].from(),r=s.countColumn(e.undefined(l.line),l.ch,n);o.push(s.spaceStr(n-r%n))}e.replaceSelections(o)},defaultTab:e=>{e.somethingSelected()?e.indentSelection("add"):e.execCommand("insertTab")},transposeChars:e=>o.runInOp(e,()=>{let o=e.listSelections(),t=[];for(let n=0;n<o.length;n++){if(!o[n].empty())continue;let l=o[n].head,c=r.getLine(e.doc,l.line).text;if(c)if(l.ch==c.length&&(l=new i.Pos(l.line,l.ch-1)),l.ch>0)l=new i.Pos(l.line,l.ch+1),e.replaceRange(c.charAt(l.ch-1)+c.charAt(l.ch-2),i.Pos(l.line,l.ch-2),l,"+transpose");else if(l.line>e.doc.first){let o=r.getLine(e.doc,l.line-1).text;o&&(l=new i.Pos(l.line,1),e.replaceRange(c.charAt(0)+e.doc.lineSeparator()+o.charAt(o.length-1),i.Pos(l.line-1,o.length-1),l,"+transpose"))}t.push(new d.Range(l,l))}e.setSelections(t)}),newlineAndIndent:e=>o.runInOp(e,()=>{let o=e.listSelections();for(let t=o.length-1;t>=0;t--)e.replaceRange(e.doc.lineSeparator(),o[t].anchor,o[t].head,"+input");o=e.listSelections();for(let t=0;t<o.length;t++)e.indentLine(o[t].from().line,null,!0);t.ensureCursorVisible(e)}),openLine:e=>e.replaceSelection("\n","start"),toggleOverwrite:e=>e.toggleOverwrite()}}});
//# sourceMappingURL=../../sourcemaps/lib/edit/commands.js.map
